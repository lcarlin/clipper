*********************************************************
* PROGRAMA     : INSERIR.PRG
* AUTOR        : DANIEL G. RODRIGUES
* DATA	       : 01/10/89
* DATA ATUALI  : 17/10/93
* FUNCAO       : IMPRIMIR CADASTROS EM ETIQUETAS
* OBS	       :	
**********************************************************
@ 01,28 SAY &INVERSO
ITEM0=[IMPRIMIR TODO O ARQUIVO ]
ITEM1=[IMPRIMIR POR ESTADO     ]
ITEM2=[IMPRIMIR POR CIDADE     ]
ITEM3=[ABANDONAR               ]
AUX1="ESTADO"
AUX2="CIDADE"
ESC4=0
@ 11,28 SAY ITEM0
SET COLOR TO W/N
@ 10,27 TO 15,52
@ 12,28 SAY ITEM1
@ 13,28 SAY ITEM2
@ 14,28 SAY ITEM3
@ 23,29 SAY "USE AS SETAS E <ENTER>"
TECLA=0
DO WHILE TECLA<>13
   ANT4=ESC4
   TECLA=0
   DO WHILE TECLA=0
      TECLA=INKEY()
   ENDDO
   DO CASE
      CASE TECLA=24
           ESC4=ESC4+1
           IF ESC4>3
              ESC4=4
           ENDIF
       CASE TECLA=5
            ESC4=ESC4-1
            IF ESC4<0
               ESC4=3
            ENDIF
    ENDCASE
    SET COLOR TO W/N
    NORMAL='ITEM'+STR(ANT4,1)
    @ ANT4+11,28 SAY &NORMAL
    SET COLOR TO N/W
    INVERSO='ITEM'+STR(ESC4,1)
    @ ESC4+11,28 SAY &INVERSO
ENDDO
SET COLOR TO W/N
@ 03,00 CLEAR
IF ESC4<>3
   IF ESC4=1
      DADO="   "
      @ 19,27 TO 21,51
      @ 20,28 SAY "ENTRE C/ O ESTADO:" GET DADO
      READ
   ENDIF
   IF ESC4=2
      DADO=SPACE(18)
      @ 19,20 TO 21,60
      @ 20,21 SAY "ENTRE C/ A CIDADE:" GET DADO
      READ
   ENDIF
   @ 03,00 CLEAR
   @ 09,22 TO 11,57 DOUBLE
   @ 10,23 SAY "LIGUE A IMPRESSORA E TECLE ALGO!!"
   TECLA=0
   DO WHILE TECLA=0
      TECLA=INKEY()
   ENDDO
   @ 08,00 CLEAR
   SET CONSOLE OFF
   SET PRINT ON
   IF ESC4=1 .OR. ESC4=2
      DADO=RTRIM(DADO)
      CAMPO='AUX'+STR(ESC4,1)
      CAMPO=&CAMPO
      LABEL FORM FORMATO FOR &CAMPO=DADO TO PRINT
   ELSE
      LABEL FORM FORMATO
   ENDIF
   SET PRINT OFF
   SET CONSOLE ON
ENDIF
DO AGENDA
RETURN
