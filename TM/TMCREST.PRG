***********************************************************
* bop TMCREST                                             *
* AUTORES: ANA PAULA, DANIELLE, EVERTON, LUIZ             *
* OBJETIVO: PERMITIR CONSULTA DAS ENTRADAS NO ESTOQUE     *
* DATA: 29/09/94                                          *
**********************************************************
close all
SELE 1
   USE TMBREST INDEX TMIEST2
   REINDEX
SELE 2
   USE TMBEST INDEX TMIEST
sombra (5,3,20,76,.f.)
@ 05,25 say "CONSULTA DE ENTRADAS"
MCODEST = 0
@  07,07 SAY "DIGITE O CODIGO DO ESTOQUE: " GET MCODEST PICT "9999"
READ
IF EMPTY(MCODEST) .AND. LASTKEY() = 13
   TABELA()
ENDIF
IF EMPTY(MCODEST) .AND. LASTKEY() = 27
   RETURN
ENDIF
sele 1
locate for CODEST = MCODEST
IF .NOT. FOUND()
   @ 13,10 SAY "ESTOQUE SEM ENTRADAS - PRESSIONE ALGO"
   INKEY(0)
   RETURN
ENDIF
SELE  2
seek MCODEST
IF .NOT. FOUND()
   @ 13,10 SAY "ESTOQUE INEXISTENTE - PRESSIONE ALGO"
   INKEY(0)
   RETURN
ENDIF
MDESC = DESC
SELE 1
SET FILTER TO CODEST = MCODEST
GO TOP
DECLARE CAMPOS[4]
CAMPOS[1] = "DATAE"
CAMPOS[2] = "QTD"
CAMPOS[3] = "VALUNIT"
CAMPOS[4] = "QTTOT"
DECLARE MASC[4]
MASC[1] = "99/99/99"
MASC[2] = "9999"
MASC[3] = "999,999.99"
MASC[4] = "9999"
DECLARE TIT[4]
TIT[1] = "DATA"
TIT[2] = "QUANTIDADE"
TIT[3] = "VALOR"
TIT[4] = "QUANTIDADE ATUAL"
desbarr(07,19,76,1)
CV=0
L=8
NUMERO=RECCOUNT()/12
CORC=SETCOLOR()
PUBLIC NUMERO, L, CV, CORC
DBEDIT(7,4,19,75,CAMPOS,"CONSULTA",MASC,TIT,.T.,.T.)
SET FILTER TO
CLOSE ALL
RELEASE NUMERO, L, CV, CORC
RETURN
* eop TMCREST