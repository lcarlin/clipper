/*
bop bk.prg
funcao   backup de *.dbf e *.dbt
data     15/06/95
*/

CLEAR
SET COLOR TO 
SET DATE BRITISH
SET SCORE  OFF
SET BELL OFF
SET PROCEDURE TO BK4

// TIPO DE VARIAVEIS

PRIVATE ARQUIVOS1, ARQUIVOS2, BK_MEM1, DRIVE, DRIVE1, DAT_BK, CABDADOS, INICIO
PRIVATE FLAG1, TIME_BK, CANCELA, REPETE, ERRO, FIM, ARQ_DBT, FIM_DBT, LAST_DISK
PRIVATE FLAG, GRAVADO, DISCO, TAM, GRV_ARQ, DISQUETE, TOT_ARQ, NUM_ARQ, COPIA
PRIVATE IND_ARQ, ARQ_DES, ARQ_FON, DISK_FREE, F_SIZE, DESTINO, FONTE, FIM_DBT
PRIVATE ARQ_FRAG, BLOC, BUFFER, R_BYTES, W_BYTES, F, COP_ARQ, CONT, STOP, NUM_ARQ1
PRIVATE FLAG, SN, PASSO, DEST_CAB, TEXTO, ARQ_CAB, TAM_CAB, W_CAB, N_ARQ, H, MESC
PRIVATE COL_BAR, COR1, XCOR1, XCOR2, NUM_FRA, DISK_CTL, DAT_CTL, HAR_CTL, FRA, ARQ_ANT
PRIVATE WDRIVE, GRV_PRIM, VETOR1, VETOR2, FRA_CTL1, FRA_CTL, TAM_CTL, LAST_CTL
PRIVATE ARQ_CTL, MP1, MP2

// CORES DA TELA
XCOR1 := 'W/B'
XCOR2 := 'R/G'

// DEFINE DRIVE A COMO INICIAL
BK_MEM1 := 0

COR1 := SETCOLOR(XCOR1)
@ 05,09 CLEAR TO 21,79
@ 05,09 TO 21,79
@ 19,10 TO 19,78
@ 07,10 TO 07,78
@ 21,24 SAY "BK - Backup p/ arquivos .DBF e .DBT"
@ 06,60 say "DRIVE: A"

MP1 := 1
DO WHILE .T.
   @ 06,11      PROMPT "Backup"
   @ 06,col()+5 PROMPT "Restaura"
   @ 06,col()+5 PROMPT "Drive"
   MENU TO MP1
   DO CASE
      CASE MP1 = 0
           EXIT
      CASE MP1 = 1
           DO BK1
      CASE MP1 = 2
           DO BK2
      CASE MP1 = 3
           DO BK3
   ENDCASE
   SETCOLOR(xCOR1)
   @ 08,10 CLEAR TO 18,78
ENDDO
SETCOLOR(COR1)
CLEAR

* EOP BK.PRG